<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="boardReplyMapper">


<!-- 
    <select id="getReplyList" parameterType="int" resultType="boardReply">
        select * from boardReply where review_no = #{reviewNo}
    </select>
    
   -->  

    <resultMap id="replyResultSet" type="boardReply">
        <result property="replyNo" column="REPLY_NO_PK"/>
        <result property="userNo" column="USER_NO_FK"/>
        <result property="replyContent" column="REPLY_CONTENT"/>
        <result property="status" column="STATUS"/>
        <result property="nickname" column="NICKNAME"/>
    </resultMap>

    <select id="getReplyList" parameterType="int" resultType="boardReply">
          <![CDATA[
        SELECT *
        FROM reply_tb
        WHERE REPLY_NO_PK = #{replyNo}
        ]]>
    </select>

<!-- 
    <insert id="addReply" parameterType="boardReply">
        insert into boardReply (user_no, review_no, reply_content, create_date) values (#{userNo}, #{reviewNo}, #{replyContent}, #{createDate})
    </insert>
  -->   

    <update id="updateReply" parameterType="boardReply">
         <![CDATA[
        UPDATE reply_tb
        SET REPLY_CONTENT=#{replyContent}
        WHERE REPLY_NO_PK=#{replyNo}
        ]]>
    </update>

    <update id="deleteReply" parameterType="map">
          <![CDATA[
        UPDATE reply_tb
        SET STATUS='N'
        WHERE REPLY_NO_PK=#{replyNo}
        ]]>
    </update>
    
    <update id="addReply" parameterType="Map">
        <![CDATA[
        INSERT INTO reply_tb(USER_NO_FK, REPLY_NO_PK, REPLY_CONTENT, NICKNAME)
        VALUES(#{reply.userNo}, #{reply.replyNo}, #{reply.replyContent}, #{nickname})
        ]]>
    </update>
    
    <select id="isAuthor" parameterType="map" resultType="Integer">
        select count(*) from board where board_no = #{replyNo} and user_no = #{userNo}
    </select>
    
    <select id="isAdmin" parameterType="map" resultType="Integer">
        select count(*) from user_tb where admin_yn = 'Y' and user_no = #{userNo}
    </select>
    
    
    
</mapper>